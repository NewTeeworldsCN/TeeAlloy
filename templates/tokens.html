<!-- templates/tokens.html -->
{% extends "base.html" %}

{% block content %}
<div class="board-container">
  <div class="form-card" style="text-align: left;">
    <!-- å¤´éƒ¨ -->
    <div style="text-align: center; margin-bottom: 30px;">
      <div class="logo-badge" style="margin: 0 auto 16px;">ğŸ”</div>
      <h2>è®¿é—®ä»¤ç‰Œ</h2>
      <p class="subtitle">ç®¡ç†ä½ çš„æ¸¸æˆæœåŠ¡å™¨è®¿é—®å‡­è¯</p>
    </div>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul class="flashes">
          {% for message in messages %}
            <li>{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <!-- å½“å‰çŠ¶æ€ -->
    {% if has_token %}
      <div style="background-color: #f8f9fa; padding: 16px; border-radius: 8px; margin-bottom: 24px;">
        <p><strong>çŠ¶æ€:</strong> âœ… å·²å¯ç”¨</p>
        <p><strong>åˆ›å»ºæ—¶é—´:</strong> {{ created_at.strftime('%Y-%m-%d %H:%M:%S') if created_at else '-' }}</p>
        <p><strong>æœ€åæ›´æ–°:</strong> {{ updated_at.strftime('%Y-%m-%d %H:%M:%S') if updated_at else '-' }}</p>
        <p><strong>æœ€åä½¿ç”¨:</strong> 
          {% if last_used %}
            {{ last_used.strftime('%Y-%m-%d %H:%M:%S') }}
          {% else %}
            å°šæœªä½¿ç”¨
          {% endif %}
        </p>
      </div>

      <form action="{{ url_for('main.refresh_token') }}" method="post" style="display:inline;">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <button type="submit" class="btn btn-warning" style="margin-right: 10px;">
          ğŸ” åˆ·æ–° Token
        </button>
      </form>

      <form action="{{ url_for('main.revoke_token') }}" method="post" style="display:inline;">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <button type="submit" class="btn btn-danger">
          âŒ æ’¤é”€ Token
        </button>
      </form>

      <div style="margin-top: 20px; padding: 15px; background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; font-size: 0.9rem;">
        <strong>âš ï¸ æ³¨æ„ï¼š</strong>
        <ul style="margin: 10px 0; padding-left: 20px;">
          <li>åˆ·æ–°åï¼Œæ—§ token ç«‹å³å¤±æ•ˆã€‚</li>
          <li>æ’¤é”€åéœ€é‡æ–°ç”Ÿæˆæ‰èƒ½ç”¨äºæ¸¸æˆæœåŠ¡å™¨ç™»å½•ã€‚</li>
          <li>è¯·ç¡®ä¿åªåœ¨å¯ä¿¡è®¾å¤‡ä¸Šä½¿ç”¨æ­¤ tokenã€‚</li>
          <li>æ ¹æ®æœåŠ¡å™¨è¦æ±‚è¾“å…¥tokenå»éªŒè¯</li>
        </ul>
      </div>
    {% else %}
      <div style="background-color: #f8f9fa; padding: 16px; border-radius: 8px; margin-bottom: 24px;">
        <p><strong>çŠ¶æ€:</strong> â›” æœªç”Ÿæˆ</p>
        <p>ä½ è¿˜æ²¡æœ‰ä¸ºæ¸¸æˆæœåŠ¡å™¨åˆ›å»ºè®¿é—®ä»¤ç‰Œã€‚</p>
      </div>

      <form action="{{ url_for('main.generate_token') }}" method="post">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <button type="submit" class="btn btn-primary btn-block">
          â• ç”Ÿæˆ Game Token
        </button>
      </form>

      <div style="margin-top: 20px; padding: 15px; background-color: #e7f5ff; border: 1px solid #b8daff; border-radius: 8px; font-size: 0.9rem;">
        <strong>â„¹ï¸ æç¤ºï¼š</strong>
        <ul style="margin: 10px 0; padding-left: 20px;">
          <li>ç”Ÿæˆåè¯·ç«‹å³å¤åˆ¶å¹¶å®‰å…¨ä¿å­˜ï¼Œç³»ç»Ÿä¸ä¼šå†æ¬¡æ˜¾ç¤ºæ˜æ–‡ã€‚</li>
          <li>è¯¥ token å…è®¸ä½ åœ¨æ¸¸æˆæœåŠ¡å™¨ä¸­è‡ªåŠ¨ç™»å½•ï¼Œæ— éœ€è¾“å…¥å¯†ç ã€‚</li>
          <li>å»ºè®®å®šæœŸåˆ·æ–°ä»¥å¢å¼ºå®‰å…¨æ€§ã€‚</li>
        </ul>
      </div>
    {% endif %}

    <!-- è¿”å›é“¾æ¥ -->
    <p style="margin-top: 30px;">
      <a href="{{ url_for('main.dashboard') }}" class="link-secondary">&lt; è¿”å›ä»ªè¡¨ç›˜</a>
    </p>
  </div>
</div>
{% endblock %}
